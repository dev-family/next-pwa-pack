# next-pwa-pack

**PWA cache provider –¥–ª—è Next.js.**  
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä, –∫—ç—à–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ —Å—Ç–∞—Ç–∏–∫—É, –¥–æ–±–∞–≤–ª—è–µ—Ç PWA-–º–∞–Ω–∏—Ñ–µ—Å—Ç –∏ offline-—Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º, SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ dev-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç:**

   ```bash
   yarn add next-pwa-pack
   # –∏–ª–∏
   npm install next-pwa-pack
   ```

2. **–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤—è—Ç—Å—è —Ñ–∞–π–ª—ã:

   - `public/sw.js`
   - `public/manifest.json`
   - `public/offline.html`

     2.1 **–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ —Ñ–∞–π–ª—ã –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å** –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

   ```bash
   node node_modules/next-pwa-pack/scripts/copy-pwa-files.mjs
   –∏–ª–∏
   npx next-pwa-pack/scripts/copy-pwa-files.mjs
   ```

3. **–û–±–≤–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä:**

   ```tsx
   // _app.tsx –∏–ª–∏ layout.tsx
   // –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–µ—Ä–≤–µ—Ä–Ω—ã–º - —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –æ–±–µ—Ä—Ç–∫—É —Å "use client"
   import { PWAProvider } from "next-pwa-pack";

   export default function App({ children }) {
     return <PWAProvider>{children}</PWAProvider>;
   }
   ```

4. **–ì–æ—Ç–æ–≤–æ!** –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç PWA, –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–∞ PWA-—Ñ–∞–π–ª—ã (`sw.js`, `manifest.json`, `offline.html`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `public`.

- –ß—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
  ```bash
  node node_modules/next-pwa-pack/scripts/copy-pwa-files.mjs
  –∏–ª–∏
  npx next-pwa-pack/scripts/copy-pwa-files.mjs
  ```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –µ—Å—Ç—å –≤ –ø–∞–ø–∫–µ `public`. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª, —É–¥–∞–ª–∏—Ç–µ –µ–≥–æ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç.

---

## üõ†Ô∏è –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### Manifest.json

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ –≤ `public/manifest.json` –ø–æ—è–≤–∏—Ç—Å—è –±–∞–∑–æ–≤—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é, –¥–æ–±–∞–≤–∏–≤ —Å–≤–æ–∏ –∏–∫–æ–Ω–∫–∏, —Ü–≤–µ—Ç–∞, –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```json
{
  "name": "MyApp",
  "short_name": "MyApp",
  "theme_color": "#ff0000",
  "background_color": "#ffffff",
  "start_url": "/",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    }
  ]
}
```

### –ü—É—Ç—å –∫ —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä—É

- –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–π –ø—É—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ–ø `swPath`:
  ```tsx
  <PWAProvider swPath="/custom-sw.js">{children}</PWAProvider>
  ```

---

## ‚ö° Dev-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

C –ø—Ä–æ–ø–æ–º `devMode` –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å "PWA Dev Tools" (–≤ –ª–µ–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É):

```tsx
<PWAProvider devMode>{children}</PWAProvider>
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞–Ω–µ–ª–∏:**

- –°—Ç–∞—Ç—É—Å –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω
- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
- –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä–∞
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä–∞ –∏ –∫—ç—à–∞
- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ/–≤–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∞ (–¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

---

## üß© API –∏ —Ö—É–∫–∏

### –•—É–∫ `usePWAStatus`

–°–ª–µ–¥–∏—Ç –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º PWA/Service Worker:

```tsx
import { usePWAStatus } from "next-pwa-pack";
const { online, hasUpdate, swInstalled, update } = usePWAStatus();
```

- `online` ‚Äî –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å
- `hasUpdate` ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `swInstalled` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä
- `update()` ‚Äî –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º –∏ SW

```ts
import {
  clearAllCache,
  reloadServiceWorker,
  updatePageCache,
  unregisterServiceWorkerAndClearCache,
  updateSWCache,
  disablePWACache,
  enablePWACache,
} from "next-pwa-pack";
```

- `clearAllCache()` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫—ç—à–∏
- `reloadServiceWorker()` ‚Äî –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- `updatePageCache(url?)` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–∫—É—â–µ–π)
- `unregisterServiceWorkerAndClearCache()` ‚Äî —É–¥–∞–ª–∏—Ç—å —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä –∏ –∫—ç—à
- `updateSWCache(urls)` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
- `disablePWACache()` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∫—ç—à (–¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
- `enablePWACache()` ‚Äî –≤–∫–ª—é—á–∏—Ç—å –∫—ç—à –æ–±—Ä–∞—Ç–Ω–æ

---

### –†–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ POST/PUT/DELETE), –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –¥–ª—è –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è SSR/ISR/SSG-—Å—Ç—Ä–∞–Ω–∏—Ü –∏–ª–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ SW-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ PWA.

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–∑–≤–∞—Ç—å `updateSWCache`, —á—Ç–æ–±—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –¥–ª—è –Ω—É–∂–Ω—ã—Ö URL –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ API-–∑–∞–ø—Ä–æ—Å–∞:

```ts
import { updateSWCache } from "next-pwa-pack";

// –ü–æ—Å–ª–µ –≤–∞—à–µ–π –º—É—Ç–∞—Ü–∏–∏ –∏–ª–∏ revalidateTag
await fetch("/api/your-endpoint", { method: "POST", body: ... });
// –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ä–µ–≤–∞–ª–∏–¥–∞—Ü–∏—è Next.js —Ç–µ–≥–∞
// await revalidateTag("your-tag");
updateSWCache(["/your-page-url"]);
```

–≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç –∫—ç—à –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤–æ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –≤–∫–ª–∞–¥–∫–∞—Ö.

---

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

–í —Ñ–∞–π–ª–µ `public/sw.js` –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è:

```js
const CACHE_EXCLUDE = ["/api/", "/admin"];
```

---

## üèóÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- **Service Worker** –∫—ç—à–∏—Ä—É–µ—Ç HTML –∏ —Å—Ç–∞—Ç–∏–∫—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç TTL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 –º–∏–Ω—É—Ç).
- **Offline.html** ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ç–∏.
- **SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏—è** ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
- **Dev Tools** ‚Äî –ø–æ–∑–≤–æ–ª—è—é—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∫—ç—à–µ–º –∏ SW –ø—Ä—è–º–æ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

---

## ‚ùì FAQ

- **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∞** –¥–µ–π—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
- **–°—Ç–∞—Ä—ã–π –∫—ç—à** –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏, –ø—Ä–æ—Å—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
- **–í–∫–ª—é—á–∏—Ç—å –∫—ç—à –æ–±—Ä–∞—Ç–Ω–æ** ‚Äî –∫–Ω–æ–ø–∫–æ–π –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
- **–§–∞–π–ª—ã –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å?**  
  –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
  ```bash
  node node_modules/next-pwa-pack/scripts/copy-pwa-files.mjs
  ```

---

## üì¶ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `PWAProvider` ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `usePWAStatus` ‚Äî —Ö—É–∫ —Å—Ç–∞—Ç—É—Å–∞
- –í—Å–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º –∏ SW

---
